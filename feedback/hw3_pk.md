# 关于基础实验三的代码长度PK
同学们好！

基础实验三还在批改中。按耐不住激动的心情，我想先和大家分享一下两道代码长度PK题的结果和体会。

我们将所有同学的代码都通过专业工具进行压缩后再计算长度。对于非根本性的错误，比如打错一个字符等，我们会先手动将其改正后再运行代码、计算代码长度。

## 结果
同学们大多完美地实现了需要的效果，非常棒！

待到实验三成绩录入网络学堂后，同学们就能查到自己的代码长度在PK的名次了。

下面公布同学们交的作业中两题最短的代码如下。
### 真·近期热门课程
最短代码是周伯通的，他的代码长度是165字节：
```
(t=document.getElementsByTagName("ul")[0]).insertBefore((v=t[w="children"])[7],v[1]);for(i=2;i;)v[1][w][i][w][0].innerHTML=--i?'刘强':'Web前端技术实训（软件学院）';0
```
### 课程列表模式下增加序号
最短代码是王宇炜的，他的代码长度是104字节：
```
z=$('.lh30');for(i=1;z[i+1];)$(z[i]).prepend('<td>'+'<p class="ml10">'+i++);$('[title^=点]').text(1<<30)
```
受王宇炜启发，我们得到了本题的更短代码，为：
```
z=$('.lh30');for(i=1;z[i+1];)$(z[i]).prepend('<td><a class=ml10>'+i++);$('a.red').text(1<<30)
```

## 体会
### 为什么要设置这两道题
首先，就是好玩。通过这两道题，能让同学们对JS的DOM操作有比较全面的理解，而且能把学到的知识应用到实际需要中去。

其次，本来是想通过这两道题给同学们做个预热，为最后的网络学堂大改造做一些铺垫。不过从实际效果来看，同学们对这两道题的完成情况更好。

最后，希望同学们能通过这两道题了解一些JS代码压缩的知识和方法。
### 对JS的理解
以上述周伯通的代码为例，像`v=t[w="children"]`这样的代码，如果你没能对JS对象的中括号取成员这样的写法有较好的理解，是很难读懂甚至写出这样的代码的。
### 挖好的坑和设计好的捷径
主要是对“课程列表模式下增加序号”有很多有趣的地方。

* 大家稍微试一下就会发现td的盒模型是没有margin的。处理办法是在td中插入另一个标签。（对于没有使用td标签的同学，我们手动帮其补出td标签，代码长度增加4）
* td中插入的节点，很多同学想到了div，但实际上那样太耗字节了，用一个字母就够了，只要别用&lt;b>和&lt;i>这样有不同显示效果的节点就行。
* 可以利用jQuery和浏览器的容错性。比如，标签即使漏了标签尾也能被浏览器正确渲染，又比如jQuery选择器如果用到了括号（不论中括号小括号），可以漏掉关闭的括号来节省字节，这就利用了jQuery的容错性。利用这一点带来的字节节省非常明显。
* 一开始tr的选择，可以像上述代码那样，也可以利用jQuery选择器tr:visible（简单粗暴有效）。这里要注意，网络学堂中写了一些隐藏table节点作为模板，一定不能对其进行修改，否则会影响课程切换后的显示效果，从而不满足实验要求。
* 最后红色数字的选择，考验大家抽取不同节点元素共性的能力，无需多言，a.red已经足够。
* 最后的最后，1073741824是2^30 ，利用这一点能节省一些字节，如上述代码。

### 谈一谈代码压缩
为了节省带宽，JS代码压缩是很常见的。常见的压缩方式包括直接压缩和eval压缩。感兴趣的同学可自行Google之进行学习尝试。
